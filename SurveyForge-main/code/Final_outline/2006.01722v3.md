1. Introduction
2. Background
2.1. Definition of System-level Provenance Graph
2.2. Typical Design of Provenance Graph-based Detection System
2.3. A Brief History of The Adoption of Provenance Graph in Threat Detection
3. Related Work and Scope of this Survey
3.1. Intrusion Detection
3.2. Provenance
3.3. Graphs for Security Purpose
3.4. Survey Methodology
4. Data Collection Module
4.1. Coarse-grained Provenance Collection
4.2. Fine-grained Provenance Collection
5. Data Management Module
5.1. Data Storage Models
6. Threat Detection Module
6.1. Attack Models
6.2. Threat Detection and Investigation System Design
7. Discussion
7.1. How the Selection of Data Models and Detection Models Will Affect Performance?
7.2. How to Solve the Dependence Explosion Problem?
7.4. Other Practical Challenges
7.5. An Ideal Detection Approach
8. Conclusion