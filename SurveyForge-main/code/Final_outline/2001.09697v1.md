1 Introduction
2 Basic Concepts
2.1 Networks Under Attack
2.2 The Knowledge Discovery in Databases Process
3 Data Collection Stage
3.1 Capturing Raw Packet Data
3.2 Capturing Flow-level Data
4 Preprocessing Stage: Derivation of Features
4.1 Derivation of Explanatory Variables
4.2 Class Labeling: Derivation of Response Variables
4.3 Publicly Available Datasets for NIDS Research
5 Preprocessing Stage: Data Cleaning and Feature Transformation
5.1 Noise Reduction
5.2 Transformation from Categorical to Numerical
5.3 Feature Scaling
5.4 Feature Discretization
6 Data Reduction
6.1 Feature Dimensionality Reduction
6.2 Sample Dimensionality Reduction
7 Data Mining Stage
7.1 Misuse-based, Anomaly-based and Hybrid Detectors
7.2 Batch vs. Incremental Learning
8 Evaluation Stage
9 Discussion, Conclusions and Open Issues
9.1 Reproducible research
9.2 Data obtention, feature extraction and public datasets
9.3 Feature transformation and dimensionality reduction
9.4 Data mining algorithms and learning schemes
9.5 NIDS evaluation beyond accuracy