1. Introduction
2. Background
2.1. Blockchain
2.2. Consensus Mechanism of Blockchain
2.3. Layers of DAPP on Blockchains
2.4. Transaction Process on Blockchain
2.5. DeFi
3. Analysis of Vulnerabilities
3.1. Data Security Vulnerabilities
3.2. Consensus Mechanism Vulnerabilities
3.3. Smart Contract Vulnerabilities
3.4. Application Layer Vulnerabilities
4. Analysis of Attack Events
4.1. Data Layer Events
4.2. Consensus Layer Events
4.3. Contract Layer Events
4.4. Application Layer Events
5. Analysis of Security Optimizations
5.1. Data Security Optimizations
5.2. P2P Network Optimizations
5.3. Consensus Layer Optimizations
5.4. Smart Contract Security Optimizations
5.5. Application Layer Optimizations
6. Challenges and Future Directions
6.1. Challenges
6.2. Future Directions
7. Conclusion