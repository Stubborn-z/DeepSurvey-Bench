1. Introduction

2. The pipeline: general description  
2.1. Event lists  
2.2. Tile creation  
2.3. Preliminary source detection  
2.4. Likelihood fit: models and parameters  
2.5. Likelihood fit: the C- and E-statistics  
2.6. Likelihood fit: the epn and dbl fits  
2.7. Parameter uncertainties  
2.8. Choosing the fitting region  
2.9. Other improvements  

3. Identifying different types of sources  
3.1. Selecting clusters  
3.2. Recovering AGN contaminated clusters and flagging double sources  

4. Testing with simulations  
4.1. Simulated sources  
4.2. Realistic background model  
4.3. Making realistic simulated XMM-Newton images  
4.4. PSF model  

5. Results  
5.1. Recovering clusters  
5.2. Recovering clusters with central AGN contamination (AC).  
5.3. Distinguishing clusters from double sources.  

6. P1 selection

7. Conclusions